@page "/users"
@using North.Core.Entities
@using North.Data.Access
@using North.RCL.Text

@inject OurDbContext _context

<MudStack Class="mud-width-full mud-height-full pa-5">
    <MudTable Items="@UsersShow" Loading="@DataLoading" Filter="@UserFilter" Height="510px" Virtualize Hover FixedHeader FixedFooter >
        <ToolBarContent>
            <MudText Typo="Typo.h6">Periodic Elements</MudText>
            <MudSpacer />
            <MudTextField @bind-Value="@SearchText" Placeholder="Search"
                          Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
        </ToolBarContent>
        <HeaderContent>
            <MudTh><IconText Icon="@Icons.Outlined.Person" Text="用户名" Typo="Typo.subtitle1" Style="width:100%;"></IconText></MudTh>
            <MudTh><IconText Icon="@Icons.Outlined.Email" Text="邮 箱" Typo="Typo.subtitle1" Style="width:100%;"></IconText></MudTh>
            <MudTh><IconText Icon="@Icons.Outlined.AdminPanelSettings" Text="权 限" Typo="Typo.subtitle1" Style="width:100%;"></IconText></MudTh>
            <MudTh><IconText Icon="@Icons.Outlined.Bolt" Text="状 态" Typo="Typo.subtitle1" Style="width:100%;"></IconText></MudTh>
            <MudTh><IconText Icon="@Icons.Outlined.Link" Text="API" Typo="Typo.subtitle1" IconStyle="transform:rotate(135deg)" Style="width:100%;"></IconText></MudTh>
            <MudTh><IconText Icon="@Icons.Outlined.FormatListBulleted" Text="上传数量 / 容量（单次）" Typo="Typo.subtitle1" Style="width:100%;"></IconText></MudTh>
            <MudTh><IconText Icon="@Icons.Outlined.Storage" Text="上传数量 / 容量（全部）" Typo="Typo.subtitle1" Style="width:100%;"></IconText></MudTh>
            <MudTh><IconText Icon="@Icons.Outlined.ModeEdit" Text="编 辑" Typo="Typo.subtitle1" Style="width:100%;"></IconText></MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="用户名" Style="text-align:center;">
                <MudLink Typo="Typo.body2" Color="Color.Info" Href="@($"/user/{context.Id}")" Underline="Underline.None" Style="width:fit-content;">@context.Name</MudLink>
            </MudTd>
            <MudTd DataLabel="邮 箱" Style="text-align:center;">
                <MudLink Typo="Typo.body2" Color="Color.Info" Href="@($"/user/{context.Id}")" Underline="Underline.None" Style="width:fit-content;">@context.Email</MudLink>
            </MudTd>
            <MudTd DataLabel="权 限" Style="text-align:center;">
                <MudChip Color="@PermissionChipColor(context.Permission)">@PermissionChipText(context.Permission)</MudChip>
            </MudTd>
            <MudTd DataLabel="状 态" Style="text-align:center;">
                <MudChip Color="@StateChipColor(context.State)">@StateChipText(context.State)</MudChip>
            </MudTd>
            <MudTd DataLabel="API" Style="text-align:center;">
                @if (context.IsApiAvailable)
                {
                    <MudChip Color="Color.Success">可 用</MudChip>
                }
                else
                {
                    <MudChip Color="Color.Error">禁 用</MudChip>
                }
            </MudTd>
            <MudTd DataLabel="上传数量 / 容量（单次）" Style="text-align:center;">@($"{context.SingleMaxUploadNums} 张 / {context.SingleMaxUploadCapacity} MB")</MudTd>
            <MudTd DataLabel="上传数量 / 容量（全部）" Style="text-align:center;">@($"{context.MaxUploadNums} 张 / {context.MaxUploadCapacity} MB")</MudTd>
            <MudTd DataLabel="编 辑" Style="text-align:center;">
                <MudButtonGroup OverrideStyles="false">
                    <MudButton Color="Color.Info" Variant="Variant.Outlined">修 改</MudButton>
                    <MudButton Color="Color.Error" Variant="Variant.Outlined">删 除</MudButton>
                </MudButtonGroup>
            </MudTd>
            </RowTemplate>
            <PagerContent>
                <MudTablePager />
            </PagerContent>
        </MudTable>
</MudStack>
